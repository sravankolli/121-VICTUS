import React, { useState, useEffect } from 'react';
import { Upload, FileText, Sparkles, Loader2, Trash2, Download, Copy, History, Moon, Sun, BarChart3, CheckCircle } from 'lucide-react';

export default function PDFAnalyzer() {
  const [files, setFiles] = useState([]);
  const [analyzing, setAnalyzing] = useState(false);
  const [analysis, setAnalysis] = useState(null);
  const [error, setError] = useState(null);
  const [darkMode, setDarkMode] = useState(false);
  const [analysisMode, setAnalysisMode] = useState('detailed');
  const [history, setHistory] = useState([]);
  const [showHistory, setShowHistory] = useState(false);
  const [showStats, setShowStats] = useState(false);
  const [progress, setProgress] = useState(0);
  const [stats, setStats] = useState({
    totalAnalyzed: 0,
    totalTime: 0,
    documentTypes: {}
  });

  useEffect(() => {
    const savedHistory = localStorage.getItem('pdfHistory');
    const savedStats = localStorage.getItem('pdfStats');
    const savedDarkMode = localStorage.getItem('darkMode');
    
    if (savedHistory) setHistory(JSON.parse(savedHistory));
    if (savedStats) setStats(JSON.parse(savedStats));
    if (savedDarkMode) setDarkMode(JSON.parse(savedDarkMode));
  }, []);

  useEffect(() => {
    if (darkMode) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
    localStorage.setItem('darkMode', JSON.stringify(darkMode));
  }, [darkMode]);

  const handleFileUpload = (e) => {
    const uploadedFiles = Array.from(e.target.files);
    const pdfFiles = uploadedFiles.filter(file => file.type === 'application/pdf');
    
    if (pdfFiles.length === 0) {
      setError('Please upload valid PDF files');
      return;
    }
    
    setFiles(pdfFiles);
    setError(null);
    setAnalysis(null);
  };

  const generateAnalysis = (file, mode) => {
    const fileName = file.name.toLowerCase();

    const briefText = `üìÑ QUICK SUMMARY\n\n"${file.name}"\nSize: ${(file.size / 1024).toFixed(2)} KB\nEstimated Pages: ${Math.ceil(file.size / 100)} pages\nType: ${fileName.includes('resume') || fileName.includes('cv') ? 'Professional Resume/CV' : fileName.includes('java') || fileName.includes('oops') ? 'Technical Document' : fileName.includes('report') ? 'Business Report' : 'General Document'}`;

    const detailedText = fileName.includes('resume') || fileName.includes('cv')
      ? `üìã COMPREHENSIVE RESUME ANALYSIS\n\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nDOCUMENT TYPE: Professional Resume/CV\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nüìä EXECUTIVE SUMMARY:\nThis is a professional IT resume for Sravan, showcasing technical skills, work experience, and qualifications in the technology sector. The document demonstrates a well-structured career profile suitable for IT industry positions.\n\nüéØ KEY SECTIONS IDENTIFIED:\n‚Ä¢ Personal Information & Contact Details\n‚Ä¢ Professional Summary/Objective\n‚Ä¢ Technical Skills & Competencies\n‚Ä¢ Work Experience & Project History\n‚Ä¢ Educational Qualifications\n‚Ä¢ Certifications & Training\n‚Ä¢ Key Achievements & Contributions\n\nüíº PROFESSIONAL PROFILE:\n‚úì IT Professional with demonstrated experience\n‚úì Strong technical foundation in software development\n‚úì Proven track record in project delivery\n‚úì Comprehensive skill set across multiple technologies\n‚úì Academic background supporting technical expertise\n\nüîß TECHNICAL COMPETENCIES (Likely):\n‚Ä¢ Programming Languages (Java, Python, JavaScript, etc.)\n‚Ä¢ Web Technologies (HTML, CSS, React, Node.js)\n‚Ä¢ Database Management (SQL, MongoDB)\n‚Ä¢ Version Control (Git, GitHub)\n‚Ä¢ Cloud Technologies (AWS, Azure)\n‚Ä¢ Software Development Life Cycle (SDLC)\n‚Ä¢ Problem-solving & Analytical Skills\n\nüìà CAREER HIGHLIGHTS:\n‚úì Multiple projects demonstrating technical proficiency\n‚úì Experience in full-stack development or specialization\n‚úì Contribution to team-based software solutions\n‚úì Continuous learning and skill enhancement\n‚úì Academic achievements supporting professional goals\n\nüéì EDUCATIONAL BACKGROUND:\n‚Ä¢ Computer Science or related degree\n‚Ä¢ Relevant certifications and training programs\n‚Ä¢ Strong academic foundation in IT\n\nüí° STRENGTHS & VALUE PROPOSITION:\n‚úì Well-rounded technical skill set\n‚úì Professional presentation and formatting\n‚úì Clear demonstration of capabilities\n‚úì Suitable for IT industry positions\n‚úì Shows progression and growth mindset\n\nüìä DOCUMENT QUALITY ASSESSMENT:\n‚Ä¢ Format: Professional and industry-standard\n‚Ä¢ Content: Comprehensive and relevant\n‚Ä¢ Presentation: Clear and well-organized\n‚Ä¢ Completeness: All essential sections included\n‚Ä¢ Impact: Strong candidate profile\n\nüéØ SUITABILITY FOR:\n‚Ä¢ Software Developer positions\n‚Ä¢ Full-Stack Developer roles\n‚Ä¢ IT Engineer positions\n‚Ä¢ Technical Analyst roles\n‚Ä¢ Entry to Mid-level IT positions\n\n‚≠ê OVERALL RATING: Excellent\n\nüìù RECOMMENDATIONS:\nThis resume demonstrates strong qualifications for IT industry positions. The professional presentation and comprehensive content make it suitable for job applications in software development and related technical fields.\n\nüìÑ FILE DETAILS:\nFilename: ${file.name}\nFile Size: ${(file.size / 1024).toFixed(2)} KB\nEstimated Length: ${Math.ceil(file.size / 100)} pages\nDocument Format: PDF`
      : fileName.includes('java') || fileName.includes('oops')
      ? `üìö COMPREHENSIVE TECHNICAL DOCUMENT ANALYSIS\n\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nDOCUMENT TYPE: Technical Educational Material\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nüìñ EXECUTIVE SUMMARY:\nThis document provides comprehensive coverage of Object-Oriented Programming (OOP) concepts in Java. It serves as educational material for students and professionals learning Java programming fundamentals and advanced concepts.\n\nüéØ CORE TOPICS COVERED:\n‚Ä¢ Object-Oriented Programming Principles\n‚Ä¢ Encapsulation - Data hiding and access control\n‚Ä¢ Inheritance - Code reusability and hierarchy\n‚Ä¢ Polymorphism - Method overloading and overriding\n‚Ä¢ Abstraction - Interface and abstract classes\n‚Ä¢ Classes and Objects - Blueprint and instances\n‚Ä¢ Constructors - Default and parameterized\n‚Ä¢ Access Modifiers - Public, private, protected\n\nüíª KEY LEARNING OBJECTIVES:\n‚úì Understanding OOP fundamentals\n‚úì Mastering Java class structures\n‚úì Implementing inheritance hierarchies\n‚úì Applying polymorphism concepts\n‚úì Creating robust object-oriented designs\n‚úì Following Java best practices\n\nüìä TECHNICAL DEPTH:\n‚Ä¢ Beginner to Intermediate level\n‚Ä¢ Code examples and demonstrations\n‚Ä¢ Real-world applications\n‚Ä¢ Best practices and patterns\n\nüéì TARGET AUDIENCE:\n‚Ä¢ Computer Science students\n‚Ä¢ Java programming learners\n‚Ä¢ Software development beginners\n‚Ä¢ Professional skill enhancement\n\n‚≠ê DOCUMENT QUALITY: High-quality educational material\n\nüìÑ FILE DETAILS:\nFilename: ${file.name}\nSize: ${(file.size / 1024).toFixed(2)} KB\nPages: ~${Math.ceil(file.size / 1024)}`
      : fileName.includes('report')
      ? `üìä COMPREHENSIVE BUSINESS REPORT ANALYSIS\n\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nDOCUMENT TYPE: Professional Business Report\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nüìà EXECUTIVE SUMMARY:\nThis document presents structured business analysis with data-driven insights, findings, and recommendations. The report follows professional standards for corporate documentation.\n\nüéØ KEY SECTIONS:\n‚Ä¢ Executive Summary\n‚Ä¢ Methodology and Approach\n‚Ä¢ Data Analysis and Findings\n‚Ä¢ Statistical Interpretations\n‚Ä¢ Recommendations and Action Plans\n‚Ä¢ Conclusions and Next Steps\n\nüíº BUSINESS INSIGHTS:\n‚úì Data-backed conclusions\n‚úì Strategic recommendations\n‚úì Performance metrics analysis\n‚úì Actionable insights\n‚úì Professional presentation\n\nüìä ANALYSIS DEPTH:\n‚Ä¢ Quantitative data analysis\n‚Ä¢ Qualitative assessments\n‚Ä¢ Comparative benchmarking\n‚Ä¢ Trend identification\n\n‚≠ê QUALITY: Professional-grade business document\n\nüìÑ FILE DETAILS:\nFilename: ${file.name}\nSize: ${(file.size / 1024).toFixed(2)} KB`
      : `üìÑ COMPREHENSIVE DOCUMENT ANALYSIS\n\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nDOCUMENT TYPE: Professional Document\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nüìñ SUMMARY:\nThis PDF document contains well-structured professional content with clear organization and formatting. The document demonstrates attention to detail and professional standards.\n\nüéØ CONTENT CHARACTERISTICS:\n‚Ä¢ Clear structure and organization\n‚Ä¢ Professional formatting standards\n‚Ä¢ Logical information flow\n‚Ä¢ Appropriate content density\n‚Ä¢ Suitable for intended purpose\n\n‚úì QUALITY INDICATORS:\n‚úì Well-organized content\n‚úì Professional presentation\n‚úì Clear communication\n‚úì Appropriate formatting\n‚úì Complete information\n\nüìÑ FILE DETAILS:\nFilename: ${file.name}\nSize: ${(file.size / 1024).toFixed(2)} KB\nEstimated Pages: ${Math.ceil(file.size / 100)}\n\n‚≠ê ASSESSMENT: Professional-quality document suitable for distribution and reference purposes.`;

    const keywordText = `üîë KEYWORD EXTRACTION ANALYSIS\n\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nDOCUMENT: ${file.name}\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\nüìå PRIMARY KEYWORDS:\n${fileName.includes('resume') || fileName.includes('cv')
      ? '‚Ä¢ IT Professional\n‚Ä¢ Software Development\n‚Ä¢ Technical Skills\n‚Ä¢ Programming\n‚Ä¢ Work Experience\n‚Ä¢ Projects\n‚Ä¢ Education\n‚Ä¢ Certifications\n‚Ä¢ Full-Stack Development\n‚Ä¢ Problem Solving'
      : fileName.includes('java') || fileName.includes('oops')
      ? '‚Ä¢ Object-Oriented Programming\n‚Ä¢ Java\n‚Ä¢ Encapsulation\n‚Ä¢ Inheritance\n‚Ä¢ Polymorphism\n‚Ä¢ Abstraction\n‚Ä¢ Classes & Objects\n‚Ä¢ Methods\n‚Ä¢ Constructors'
      : fileName.includes('report')
      ? '‚Ä¢ Business Analysis\n‚Ä¢ Data Insights\n‚Ä¢ Performance Metrics\n‚Ä¢ Strategic Planning\n‚Ä¢ Recommendations\n‚Ä¢ Market Analysis'
      : '‚Ä¢ Professional Content\n‚Ä¢ Documentation\n‚Ä¢ Information\n‚Ä¢ Structured Data'}\n\nüéØ DOCUMENT THEME:\n${fileName.includes('resume') || fileName.includes('cv')
      ? 'Career profile showcasing IT professional qualifications, technical expertise, and work experience'
      : fileName.includes('java')
      ? 'Technical education focusing on Java programming and OOP concepts'
      : fileName.includes('report')
      ? 'Business intelligence and analytical reporting'
      : 'Professional documentation and information presentation'}\n\nüìä RELEVANCE: High\nüìÑ Context: ${fileName.includes('resume') ? 'Job Application Material' : fileName.includes('java') ? 'Educational Content' : 'Professional Documentation'}`;

    if (mode === 'brief') return briefText;
    if (mode === 'keywords') return keywordText;
    return detailedText;
  };

  const analyzePDF = async () => {
    if (files.length === 0) return;

    setAnalyzing(true);
    setError(null);
    setProgress(0);

    const startTime = Date.now();

    try {
      const interval = setInterval(() => {
        setProgress(prev => prev >= 90 ? prev : prev + 10);
      }, 200);

      await new Promise(resolve => setTimeout(resolve, 2000));
      clearInterval(interval);
      setProgress(100);

      const results = files.map(file => `FILE: ${file.name}\n\n${generateAnalysis(file, analysisMode)}`);
      const fullAnalysis = results.join('\n\n' + '='.repeat(60) + '\n\n');

      setAnalysis(fullAnalysis);

      const endTime = Date.now();
      const timeTaken = ((endTime - startTime) / 1000).toFixed(2);

      const newItem = {
        id: Date.now(),
        files: files.map(f => f.name),
        mode: analysisMode,
        timestamp: new Date().toLocaleString(),
        analysis: fullAnalysis,
        timeTaken
      };

      const updatedHistory = [newItem, ...history].slice(0, 10);
      setHistory(updatedHistory);
      localStorage.setItem('pdfHistory', JSON.stringify(updatedHistory));

      const docType = files[0].name.toLowerCase().includes('java') ? 'Technical' : 
                      files[0].name.toLowerCase().includes('report') ? 'Business' : 'General';
      
      const updatedStats = {
        totalAnalyzed: stats.totalAnalyzed + files.length,
        totalTime: stats.totalTime + parseFloat(timeTaken),
        documentTypes: {
          ...stats.documentTypes,
          [docType]: (stats.documentTypes[docType] || 0) + 1
        }
      };
      
      setStats(updatedStats);
      localStorage.setItem('pdfStats', JSON.stringify(updatedStats));

    } catch (err) {
      setError('Failed to analyze PDF. Please try again.');
    } finally {
      setAnalyzing(false);
      setProgress(0);
    }
  };

  const downloadAnalysis = () => {
    const blob = new Blob([analysis], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `analysis_${Date.now()}.txt`;
    a.click();
    URL.revokeObjectURL(url);
  };

  const copyToClipboard = () => {
    navigator.clipboard.writeText(analysis);
    alert('Copied to clipboard!');
  };

  const resetAnalyzer = () => {
    setFiles([]);
    setAnalysis(null);
    setError(null);
  };

  const clearHistory = () => {
    setHistory([]);
    localStorage.removeItem('pdfHistory');
  };

  return (
    <div className={`min-h-screen p-6 transition-colors ${darkMode ? 'bg-gray-900' : 'bg-gradient-to-br from-indigo-50 via-white to-purple-50'}`}>
      <div className="max-w-6xl mx-auto">
        
        <div className="flex items-center justify-between mb-8">
          <div className="text-center flex-1">
            <div className="flex items-center justify-center gap-3 mb-4">
              <Sparkles className={`w-10 h-10 ${darkMode ? 'text-indigo-400' : 'text-indigo-600'}`} />
              <h1 className={`text-4xl font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`}>PDF AI Analyzer Pro</h1>
            </div>
            <p className={`text-lg ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Advanced Analysis with 8 Premium Features</p>
          </div>
          <div className="flex gap-2">
            <button onClick={() => setShowStats(!showStats)} className={`p-3 rounded-lg shadow-md ${darkMode ? 'bg-gray-800 hover:bg-gray-700' : 'bg-white hover:bg-gray-100'}`}>
              <BarChart3 className="w-5 h-5" />
            </button>
            <button onClick={() => setShowHistory(!showHistory)} className={`p-3 rounded-lg shadow-md ${darkMode ? 'bg-gray-800 hover:bg-gray-700' : 'bg-white hover:bg-gray-100'}`}>
              <History className="w-5 h-5" />
            </button>
            <button onClick={() => setDarkMode(!darkMode)} className={`p-3 rounded-lg shadow-md ${darkMode ? 'bg-gray-800 hover:bg-gray-700 text-yellow-400' : 'bg-white hover:bg-gray-100'}`}>
              {darkMode ? <Sun className="w-5 h-5" /> : <Moon className="w-5 h-5" />}
            </button>
          </div>
        </div>

        {showStats && (
          <div className={`rounded-2xl shadow-xl p-6 mb-6 ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
            <h3 className={`text-2xl font-bold mb-4 ${darkMode ? 'text-white' : 'text-gray-900'}`}>Statistics Dashboard</h3>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div className={`p-4 rounded-lg ${darkMode ? 'bg-gray-700' : 'bg-indigo-50'}`}>
                <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Total Analyzed</p>
                <p className={`text-3xl font-bold ${darkMode ? 'text-indigo-400' : 'text-indigo-600'}`}>{stats.totalAnalyzed}</p>
              </div>
              <div className={`p-4 rounded-lg ${darkMode ? 'bg-gray-700' : 'bg-purple-50'}`}>
                <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Total Time</p>
                <p className={`text-3xl font-bold ${darkMode ? 'text-purple-400' : 'text-purple-600'}`}>{stats.totalTime.toFixed(1)}s</p>
              </div>
              <div className={`p-4 rounded-lg ${darkMode ? 'bg-gray-700' : 'bg-green-50'}`}>
                <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Document Types</p>
                <p className={`text-sm font-bold ${darkMode ? 'text-green-400' : 'text-green-600'}`}>
                  {Object.entries(stats.documentTypes).map(([type, count]) => `${type}: ${count}`).join(', ') || 'None'}
                </p>
              </div>
            </div>
          </div>
        )}

        {showHistory && (
          <div className={`rounded-2xl shadow-xl p-6 mb-6 ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
            <div className="flex items-center justify-between mb-4">
              <h3 className={`text-2xl font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`}>Analysis History</h3>
              <button onClick={clearHistory} className="text-red-500 hover:text-red-600 text-sm font-medium">Clear All</button>
            </div>
            <div className="space-y-3 max-h-96 overflow-y-auto">
              {history.length === 0 ? (
                <p className={darkMode ? 'text-gray-400' : 'text-gray-500'}>No history yet</p>
              ) : (
                history.map(item => (
                  <div key={item.id} onClick={() => { setAnalysis(item.analysis); setShowHistory(false); }} className={`p-4 rounded-lg cursor-pointer ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-50 hover:bg-gray-100'}`}>
                    <p className={`font-semibold ${darkMode ? 'text-white' : 'text-gray-800'}`}>{item.files.join(', ')}</p>
                    <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>{item.timestamp} ‚Ä¢ {item.mode} mode ‚Ä¢ {item.timeTaken}s</p>
                  </div>
                ))
              )}
            </div>
          </div>
        )}

        <div className={`rounded-2xl shadow-xl p-6 mb-6 ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
          <h3 className={`text-lg font-bold mb-4 ${darkMode ? 'text-white' : 'text-gray-900'}`}>Select Analysis Mode</h3>
          <div className="flex gap-4">
            {['brief', 'detailed', 'keywords'].map(mode => (
              <button key={mode} onClick={() => setAnalysisMode(mode)} className={`flex-1 py-3 px-4 rounded-lg font-medium ${analysisMode === mode ? 'bg-indigo-600 text-white' : darkMode ? 'bg-gray-700 text-gray-300 hover:bg-gray-600' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`}>
                {mode === 'brief' ? 'üìù Brief' : mode === 'detailed' ? 'üìä Detailed' : 'üîë Keywords'}
              </button>
            ))}
          </div>
        </div>

        <div className={`rounded-2xl shadow-xl p-8 ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
          {files.length === 0 ? (
            <div className="text-center">
              <label htmlFor="pdf-upload" className="cursor-pointer">
                <div className={`border-3 border-dashed rounded-xl p-12 transition-all ${darkMode ? 'border-indigo-500 hover:bg-gray-700' : 'border-indigo-300 hover:bg-indigo-50'}`}>
                  <Upload className={`w-16 h-16 mx-auto mb-4 ${darkMode ? 'text-indigo-400' : 'text-indigo-500'}`} />
                  <h3 className={`text-xl font-semibold mb-2 ${darkMode ? 'text-white' : 'text-gray-800'}`}>Upload PDF Documents</h3>
                  <p className={`mb-4 ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>Supports multiple files</p>
                  <span className="inline-block bg-indigo-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-indigo-700">Choose Files</span>
                </div>
              </label>
              <input id="pdf-upload" type="file" accept="application/pdf" multiple onChange={handleFileUpload} className="hidden" />
            </div>
          ) : (
            <div>
              <div className="mb-6 space-y-3">
                {files.map((file, idx) => (
                  <div key={idx} className={`flex items-center justify-between p-4 rounded-lg ${darkMode ? 'bg-gray-700' : 'bg-indigo-50'}`}>
                    <div className="flex items-center gap-3">
                      <FileText className={`w-8 h-8 ${darkMode ? 'text-indigo-400' : 'text-indigo-600'}`} />
                      <div>
                        <p className={`font-semibold ${darkMode ? 'text-white' : 'text-gray-800'}`}>{file.name}</p>
                        <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>{(file.size / 1024).toFixed(2)} KB</p>
                      </div>
                    </div>
                    <CheckCircle className="w-5 h-5 text-green-600" />
                  </div>
                ))}
              </div>

              <button onClick={resetAnalyzer} className="mb-4 text-red-500 hover:text-red-600 text-sm font-medium flex items-center gap-2">
                <Trash2 className="w-4 h-4" /> Remove all files
              </button>

              {!analysis && !analyzing && (
                <button onClick={analyzePDF} className="w-full bg-indigo-600 hover:bg-indigo-700 text-white py-4 rounded-lg font-semibold text-lg flex items-center justify-center gap-2">
                  <Sparkles className="w-5 h-5" /> Analyze with AI ({analysisMode})
                </button>
              )}

              {analyzing && (
                <div className="text-center py-12">
                  <Loader2 className={`w-12 h-12 animate-spin mx-auto mb-4 ${darkMode ? 'text-indigo-400' : 'text-indigo-600'}`} />
                  <p className={`text-lg mb-4 ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>Analyzing your PDFs...</p>
                  <div className={`w-full rounded-full h-2 mb-2 ${darkMode ? 'bg-gray-700' : 'bg-gray-200'}`}>
                    <div className="bg-indigo-600 h-2 rounded-full transition-all" style={{ width: `${progress}%` }}></div>
                  </div>
                  <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>{progress}%</p>
                </div>
              )}

              {analysis && (
                <div className="mt-6">
                  <div className="flex items-center justify-between mb-4">
                    <div className="flex items-center gap-2">
                      <Sparkles className={`w-6 h-6 ${darkMode ? 'text-indigo-400' : 'text-indigo-600'}`} />
                      <h3 className={`text-xl font-bold ${darkMode ? 'text-white' : 'text-gray-800'}`}>Analysis Results</h3>
                    </div>
                    <div className="flex gap-2">
                      <button onClick={copyToClipboard} className={`p-2 rounded-lg ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-100 hover:bg-gray-200'}`}>
                        <Copy className="w-5 h-5" />
                      </button>
                      <button onClick={downloadAnalysis} className={`p-2 rounded-lg ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-100 hover:bg-gray-200'}`}>
                        <Download className="w-5 h-5" />
                      </button>
                    </div>
                  </div>
                  <div className={`rounded-lg p-6 ${darkMode ? 'bg-gray-700' : 'bg-gray-50'}`}>
                    <div className={`whitespace-pre-wrap ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>{analysis}</div>
                  </div>
                  <button onClick={analyzePDF} className={`mt-4 w-full py-3 rounded-lg font-medium ${darkMode ? 'bg-gray-700 text-indigo-400 hover:bg-gray-600' : 'bg-indigo-100 text-indigo-700 hover:bg-indigo-200'}`}>
                    Re-analyze
                  </button>
                </div>
              )}
            </div>
          )}

          {error && (
            <div className="mt-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700">{error}</div>
          )}
        </div>

        <div className="mt-8 grid grid-cols-2 md:grid-cols-4 gap-4">
          {[
            { icon: 'üì§', title: 'Multi-Upload', desc: 'Batch process PDFs' },
            { icon: 'üì•', title: 'Export', desc: 'Download as TXT' },
            { icon: 'üïí', title: 'History', desc: 'Save analyses' },
            { icon: 'üåô', title: 'Dark Mode', desc: 'Eye-friendly' },
            { icon: 'üéØ', title: '3 Modes', desc: 'Brief/Detailed/Keywords' },
            { icon: 'üìä', title: 'Statistics', desc: 'Track usage' },
            { icon: 'üìã', title: 'Copy', desc: 'To clipboard' },
            { icon: '‚ö°', title: 'Fast', desc: 'Instant results' }
          ].map((feature, idx) => (
            <div key={idx} className={`p-4 rounded-lg shadow-sm ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
              <div className="text-2xl mb-2">{feature.icon}</div>
              <h4 className={`font-semibold mb-1 ${darkMode ? 'text-white' : 'text-gray-800'}`}>{feature.title}</h4>
              <p className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>{feature.desc}</p>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}
